# ====== NOMOR 3: PRAPROSES DATA ======

# 3.a Pisahkan atribut prediktor dan label
label_col = "HeartDisease"
X = df.drop(columns=[label_col])
y = df[label_col]

# Bagi ke numeric dan kategorik
numeric_cols = X.select_dtypes(include=["int64", "float64"]).columns.tolist()
categorical_cols = X.select_dtypes(include=["object"]).columns.tolist()

print("Fitur numerik:", numeric_cols)
print("Fitur kategorik:", categorical_cols)

# ---------- 3.b SimpleImputer (mean) untuk numerik ----------
imputer = SimpleImputer(strategy="mean")
X_num_imputed = pd.DataFrame(imputer.fit_transform(X[numeric_cols]),
                             columns=numeric_cols)

print("\nMissing value setelah imputasi (numerik):")
print(X_num_imputed.isna().sum())

# ---------- 3.c StandardScaler untuk numerik ----------
scaler = StandardScaler()
X_num_scaled = pd.DataFrame(scaler.fit_transform(X_num_imputed),
                            columns=numeric_cols)

print("\nStatistik deskriptif numerik SETELAH scaling:")
print(X_num_scaled.describe())

# ---------- 3.d Praproses tambahan: One-Hot Encoding kategorik ----------
X_cat_encoded = pd.get_dummies(X[categorical_cols], drop_first=False)

print("\nContoh hasil one-hot encoding (5 baris pertama):")
print(X_cat_encoded.head())

# ---------- Gabungkan numerik ter-scale + kategorik ter-encode ----------
X_processed = pd.concat([X_num_scaled, X_cat_encoded], axis=1)

print("\nShape after preprocessing:", X_processed.shape)
print("Statistik deskriptif numerik SEBELUM praproses:")
print(df[numeric_cols].describe())


Penjelasan
3.a: X berisi 11 atribut prediktor, y = HeartDisease.
3.b: numerik diimputasi dengan rata-rata pakai SimpleImputer(strategy='mean').
3.c: semua fitur numerik distandarisasi → mean ≈ 0, std ≈ 1.
3.d (tambahan praproses dari nomor 1.c): atribut tekstual diubah ke angka pakai one-hot encoding.
3.e: statistik deskriptif sebelum–sesudah bisa kamu ambil dari:
df.describe() → sebelum praproses
X_num_scaled.describe() → sesudah scaling.
