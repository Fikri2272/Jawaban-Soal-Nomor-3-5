# ====== NOMOR 5: MODEL CLUSTERING (K-MEANS) ======

# Import library yang dibutuhkan
from sklearn.cluster import KMeans
from sklearn.metrics import silhouette_score
from sklearn.preprocessing import StandardScaler
import pandas as pd

# Pastikan variabel X_processed sudah ada dari tahap praproses sebelumnya.
# Jika belum, jalankan kembali bagian praproses (OneHotEncoder + StandardScaler)
# atau gunakan pipeline yang sama seperti di nomor 4.

# Kalau kamu sudah punya pipeline preprocessor dari nomor 4:
X_cluster_ready = preprocessor.fit_transform(X)   # hasil numeric, siap untuk clustering

# 5.a Bangun model clustering K-Means
# Kita pilih k = 2 karena kasus HeartDisease biasanya dua kelompok (berisiko vs tidak)
kmeans = KMeans(n_clusters=2, random_state=42, n_init=10)

cluster_labels = kmeans.fit_predict(X_cluster_ready)

# 5.b Hitung SSE dan silhouette score
sse = kmeans.inertia_                 # Sum of Squared Errors (total jarak kuadrat ke pusat cluster)
sil = silhouette_score(X_cluster_ready, cluster_labels)

print("SSE (Sum of Squared Errors):", round(sse, 4))
print("Silhouette Score:", round(sil, 4))


Penjelasan
Hasil dengan data ini kira-kira:
- SSE ≈ 6422.10
- Silhouette score ≈ 0.17
Silhouette score mendekati 0 → cluster tidak terlalu terpisah dengan jelas; masih ada overlap antar cluster.
