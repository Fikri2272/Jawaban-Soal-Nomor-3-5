# ====== NOMOR 4: MODEL KLASIFIKASI (LOGISTIC REGRESSION) ======

# Import library
import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import confusion_matrix, accuracy_score, classification_report
from sklearn.preprocessing import OneHotEncoder, StandardScaler
from sklearn.impute import SimpleImputer
from sklearn.compose import ColumnTransformer
from sklearn.pipeline import Pipeline

# === 1. Baca dataset ===
df = pd.read_csv("heart_modified.csv")

# Tentukan kolom label
label_col = "FastingBS"      # ubah sesuai label di datasetmu
X = df.drop(columns=[label_col])
y = df[label_col]

# === 2. Pisahkan kolom numerik dan kategorik ===
numeric_cols = X.select_dtypes(include=[np.number]).columns
categorical_cols = X.select_dtypes(exclude=[np.number]).columns

print("Kolom numerik :", numeric_cols.tolist())
print("Kolom kategorik :", categorical_cols.tolist())

# === 3. Buat pipeline praproses ===
numeric_transformer = Pipeline(steps=[
    ("imputer", SimpleImputer(strategy="mean")),
    ("scaler", StandardScaler())
])

categorical_transformer = Pipeline(steps=[
    ("imputer", SimpleImputer(strategy="most_frequent")),
    ("onehot", OneHotEncoder(handle_unknown="ignore"))
])

preprocessor = ColumnTransformer(
    transformers=[
        ("num", numeric_transformer, numeric_cols),
        ("cat", categorical_transformer, categorical_cols)
    ]
)

# === 4. Bagi data (85% train, 15% test) ===
X_train, X_test, y_train, y_test = train_test_split(
    X, y,
    test_size=0.15,
    random_state=42,
    stratify=y
)

# === 5. Pipeline akhir: preprocessing + model ===
clf = Pipeline(steps=[
    ("preprocessor", preprocessor),
    ("classifier", LogisticRegression(max_iter=1000, random_state=42))
])

# === 6. Latih model ===
clf.fit(X_train, y_train)

# === 7. Prediksi ===
y_pred = clf.predict(X_test)

# === 8. Evaluasi model ===
cm = confusion_matrix(y_test, y_pred)
acc = accuracy_score(y_test, y_pred)

print("\nConfusion Matrix:\n", cm)
print("\nAkurasi Model :", round(acc, 4))
print("\nLaporan Klasifikasi:\n", classification_report(y_test, y_pred))



Penjelasan
- Confusion Matrix
\[54,8,
  7,69]
- Akurasi
≈ 0.8913 → 89.13%
